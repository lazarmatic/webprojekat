<div class="container mt-4">
  <h1 class="text-center mb-4 text-primary fw-bold" id="bookTitle">
    Find yourself a book!
  </h1>
<!-- test 2-->
  <div class="mb-3">
    <input
      type="text"
      id="searchBar"
      class="form-control"
      placeholder="Search for books..."
      onkeyup="filterBooks()"
    />
  </div>
  <div class="row" id="book-list">
    <div class="col-md-3 mb-4">
      <div class="card book-card">
        <img
          src="/frontend/assets/images/tgg.png"
          class="card-img-top"
          alt="The Great Gatsby"
        />
        <div class="card-body">
          <h5 class="card-title">The Great Gatsby</h5>
          <p class="card-text"><strong>Author:</strong> F. Scott Fitzgerald</p>
          <p class="card-text">A classic novel set in the Jazz Age.</p>
          <button
            class="btn btn-primary"
            onclick="openRentModal('The Great Gatsby', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/tgg.png')"
          >
            Rent
          </button>
          <button
            class="btn btn-primary"
            onclick="openBuyModal('The Great Gatsby', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/tgg.png')"
          >
            Buy
          </button>
          <button
            class="btn btn-primary"
            onclick="openReviewsModal('The Great Gatsby' , 'F. Scott Fitzgerald' , 'A classic novel set in the Jazz Age.' ,'/frontend/assets/images/tgg.png'  )"
            (bookTitle,
            bookAuthor,
            bookDescription,
            bookImage)
          >
            More
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card book-card">
        <img
          src="/frontend/assets/images/md.jpg"
          class="card-img-top"
          alt="Moby Dick"
        />
        <div class="card-body">
          <h5 class="card-title">Moby Dick</h5>
          <p class="card-text"><strong>Author:</strong> F. Scott Fitzgerald</p>
          <p class="card-text">A classic novel set in the Jazz Age.</p>
          <button
            class="btn btn-primary"
            onclick="openRentModal('Moby Dick', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/md.jpg')"
          >
            Rent
          </button>
          <button
            class="btn btn-primary"
            onclick="openBuyModal('Moby Dick', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/md.jpg')"
          >
            Buy
          </button>
          <button
            class="btn btn-primary"
            onclick="openReviewsModal('Moby Dick', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/md.jpg')"
            (bookTitle,
            bookAuthor,
            bookDescription,
            bookImage)
          >
            More
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card book-card">
        <img
          src="/frontend/assets/images/1984.jpg"
          class="card-img-top"
          alt="1984"
        />
        <div class="card-body">
          <h5 class="card-title">1984</h5>
          <p class="card-text"><strong>Author:</strong> F. Scott Fitzgerald</p>
          <p class="card-text">A classic novel set in the Jazz Age.</p>
          <button
            class="btn btn-primary"
            onclick="openRentModal('1984', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/1984.jpg')"
          >
            Rent
          </button>
          <button
            class="btn btn-primary"
            onclick="openBuyModal('1984', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/1984.jpg')"
          >
            Buy
          </button>
          <button
            class="btn btn-primary"
            onclick="openReviewsModal('1984', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/1984.jpg')"
            (bookTitle,
            bookAuthor,
            bookDescription,
            bookImage)
          >
            More
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card book-card">
        <img
          src="/frontend/assets/images/tkam.jpg"
          class="card-img-top"
          alt="tkam.jpg"
        />
        <div class="card-body">
          <h5 class="card-title">To Kill A Mockingbird</h5>
          <p class="card-text"><strong>Author:</strong> F. Scott Fitzgerald</p>
          <p class="card-text">A classic novel set in the Jazz Age.</p>
          <button
            class="btn btn-primary"
            onclick="openRentModal('To Kill A Mockingbird', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/tkam.jpg')"
          >
            Rent
          </button>
          <button
            class="btn btn-primary"
            onclick="openBuyModal('To Kill A Mockingbird', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/tkam.jpg')"
          >
            Buy
          </button>
          <button
            class="btn btn-primary"
            onclick="openReviewsModal('To Kill A Mockingbird', 'F. Scott Fitzgerald', 'A classic novel set in the Jazz Age.', '/frontend/assets/images/tkam.jpg')"
            (bookTitle,
            bookAuthor,
            bookDescription,
            bookImage)
          >
            More
          </button>
        </div>
      </div>
    </div>

    <!-- Repeat for other books -->
  </div>

  <!-- Reviews Modal -->
  <div
    class="modal fade"
    id="reviewsModal"
    tabindex="-1"
    aria-labelledby="reviewsModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg">
      <!-- Larger modal -->
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="reviewsModalLabel">ðŸ“– Details</h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body">
          <!-- Book General Info -->
          <div
            class="d-flex align-items-center p-3 border rounded shadow-sm mb-4"
          >
            <img
              id="reviewBookImage"
              src=""
              class="img-fluid rounded me-3"
              alt="Book Cover"
              style="width: 30%; box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2)"
            />
            <div>
              <h4 id="reviewBookTitle" class="fw-bold text-primary"></h4>
              <p class="mb-1">
                <strong>Author:</strong> <span id="reviewBookAuthor"></span>
              </p>
              <p id="reviewBookDescription" class="text-muted"></p>
            </div>
          </div>

          <hr />

          <!-- User Reviews Section -->
          <h5 class="fw-bold">ðŸ’¬ User Reviews</h5>
          <div id="reviewsContainer" class="mb-4"></div>
          <!-- Reviews will be dynamically added here -->

          <hr />

          <!-- Add Review Section -->
          <h5 class="fw-bold">âž• Add a Review</h5>
          <div class="mb-3">
            <input
              type="text"
              id="reviewUserName"
              class="form-control border-primary shadow-sm"
              placeholder="Your Name"
            />
          </div>
          <div class="mb-3">
            <textarea
              id="reviewUserText"
              class="form-control border-primary shadow-sm"
              rows="3"
              placeholder="Write your review..."
            ></textarea>
          </div>
          <button
            class="btn btn-primary w-100 fw-bold shadow-sm"
            onclick="addReview()"
          >
            Submit Review
          </button>
        </div>

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary fw-bold"
            data-bs-dismiss="modal"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Rent Modal -->
  <div
    class="modal fade"
    id="rentModal"
    tabindex="-1"
    aria-labelledby="rentModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="rentModalLabel">Rent a Book</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body d-flex">
          <img
            id="rentBookImage"
            src=""
            class="img-fluid me-3"
            alt="Book Cover"
            style="width: 40%"
          />
          <div>
            <h5 id="rentBookTitle"></h5>
            <p><strong>Author:</strong> <span id="rentBookAuthor"></span></p>
            <p id="rentBookDescription"></p>
            <p><strong>Rent Price:</strong> $9.99</p>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Close
          </button>
          <button type="button" class="btn btn-primary">Confirm Rent</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Buy Modal -->
  <div
    class="modal fade"
    id="buyModal"
    tabindex="-1"
    aria-labelledby="buyModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="buyModalLabel">Buy a Book</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body d-flex">
          <img
            id="buyBookImage"
            src=""
            class="img-fluid me-3"
            alt="Book Cover"
            style="width: 40%"
          />
          <div>
            <h5 id="buyBookTitle"></h5>
            <p><strong>Author:</strong> <span id="buyBookAuthor"></span></p>
            <p id="buyBookDescription"></p>
            <p><strong>Buy Price:</strong> $19.99</p>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Close
          </button>
          <button type="button" class="btn btn-primary">Confirm Buy</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  function openRentModal(title, author, description, imageUrl) {
    document.getElementById("rentBookTitle").innerText = title;
    document.getElementById("rentBookAuthor").innerText = author;
    document.getElementById("rentBookDescription").innerText = description;
    document.getElementById("rentBookImage").src = imageUrl;

    var rentModal = new bootstrap.Modal(document.getElementById("rentModal"));
    rentModal.show();
  }
  function filterBooks() {
    let input = document.getElementById("searchBar").value.toLowerCase();
    let books = document.getElementsByClassName("book-card");

    for (let book of books) {
      let titleElement = book.getElementsByClassName("card-title")[0];
      let title = titleElement.innerText.toLowerCase();

      if (title.includes(input)) {
        book.parentElement.style.display = "block";
        titleElement.innerHTML = titleElement.innerText.replace(
          new RegExp(input, "gi"),
          (match) => `<span class='highlight'>${match}</span>`
        );
      } else {
        book.parentElement.style.display = "none";
      }
    }
  }
  function openBuyModal(title, author, description, imageUrl) {
    document.getElementById("buyBookTitle").innerText = title;
    document.getElementById("buyBookAuthor").innerText = author;
    document.getElementById("buyBookDescription").innerText = description;
    document.getElementById("buyBookImage").src = imageUrl;

    var buyModal = new bootstrap.Modal(document.getElementById("buyModal"));
    buyModal.show();
  }
  function openReviewsModal(bookTitle, bookAuthor, bookDescription, bookImage) {
    document.getElementById("reviewBookTitle").innerText = bookTitle;
    document.getElementById("reviewBookAuthor").innerText = bookAuthor;
    document.getElementById("reviewBookDescription").innerText =
      bookDescription;
    document.getElementById("reviewBookImage").src = bookImage;

    // Example reviews (Replace this with real database data)
    const reviews = [
      {
        user: "Alice",
        comment: "Absolutely loved this book! A timeless classic.",
      },
      {
        user: "Bob",
        comment: "A bit slow at times, but overall a great read.",
      },
      {
        user: "Charlie",
        comment: "One of my all-time favorites. Highly recommend!",
      },
    ];

    // Clear previous reviews
    const reviewsContainer = document.getElementById("reviewsContainer");
    reviewsContainer.innerHTML = "";

    // Populate the modal with reviews
    reviews.forEach((review) => {
      const reviewElement = document.createElement("div");
      reviewElement.classList.add(
        "card",
        "mb-3",
        "shadow-sm",
        "border-light",
        "review-card"
      );
      reviewElement.innerHTML = `
        <div class="card-body">
          <h6 class="fw-bold text-primary">${review.user}</h6>
          <p class="text-muted mb-0">${review.comment}</p>
        </div>`;
      reviewsContainer.appendChild(reviewElement);
    });

    // Open the modal
    var reviewsModal = new bootstrap.Modal(
      document.getElementById("reviewsModal")
    );
    reviewsModal.show();
  }

  function addReview() {
    const userName = document.getElementById("reviewUserName").value.trim();
    const userText = document.getElementById("reviewUserText").value.trim();

    if (userName === "" || userText === "") {
      alert("Please enter your name and a review.");
      return;
    }

    const reviewsContainer = document.getElementById("reviewsContainer");
    const newReview = document.createElement("div");
    newReview.classList.add("card", "mb-3", "shadow-sm", "border-light");
    newReview.innerHTML = `
      <div class="card-body">
        <h6 class="fw-bold text-primary">${userName}</h6>
        <p class="text-muted mb-0">${userText}</p>
      </div>`;

    reviewsContainer.appendChild(newReview);

    // Clear input fields after submission
    document.getElementById("reviewUserName").value = "";
    document.getElementById("reviewUserText").value = "";
  }
</script>
